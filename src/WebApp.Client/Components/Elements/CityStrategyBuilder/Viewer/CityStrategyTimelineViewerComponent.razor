@using System.Collections.ObjectModel
@using Ingweland.Fog.Application.Client.Web.Localization
@using Ingweland.Fog.Models.Fog.Entities
@using Microsoft.Extensions.Localization
@using Size = MudBlazor.Size
@inherits CityStrategyTimelineComponentBase
@inject  IStringLocalizer<FogResource> Loc
<div class="component-root">
    <div class="name-container">@Loc[FogResource.CityStrategy_Timeline]</div>
    <div class="main-container">
        <MudList T="CityStrategyTimelineItemBase" Gutters="false" Dense="true" SelectedValue="@_selectedItem">
            @for (var i = 0; i < Items.Count; i++)
            {
                var item = Items[i];
                var index = i + 1;
                <MudListItem T="CityStrategyTimelineItemBase" Value="@item"
                             OnClick="@(() => OnSelect.InvokeAsync(item.Id))">
                    <div class="timeline-item-content">
                        <div class="list-index">@index</div>
                        <div class="timeline-item-content-icon">
                            <MudIcon Icon="@GetTypeIcon(item.Type)" Color="Color.Inherit" Size="Size.Large"/>
                        </div>
                        <span>@item.Title</span>
                    </div>
                </MudListItem>
            }
        </MudList>
    </div>
</div>

@code {
    private CityStrategyTimelineItemBase? _selectedItem;

    [Parameter]
    [EditorRequired]
    public required ObservableCollection<CityStrategyTimelineItemBase> Items { get; set; }

    [Parameter]
    public EventCallback<string> OnSelect { get; set; }

    protected override void OnParametersSet()
    {
        base.OnParametersSet();
        _selectedItem = Items.FirstOrDefault(x => x.Selected);
    }

}